$(function(){var t=$(window),e="is-active",i="fix",a=$("header h1"),n=a.is(":hidden")?0:a.height(),s=142,o=$("#switch").attr("data-switch"),r=o?JSON.parse(o):"",c={prefix:"edeity-theme_",throttle:function(t,e){e=Number(e)||0;var i,a,n=Date.now(),s=null;return function(o){var r=Date.now();i=this;var c=r-n;return void 0===a?(n=r,a=-1,s=t.apply(this,o)):c<e?(clearTimeout(a),a=setTimeout(function(){return t.apply(i,o),s},e-c),s):(n=r,t.apply(this,o),s)}},scrollTo:function(t,e){e||(e=0);var i=$("html, body");if(i.animate)return isFromClick=!0,i.animate({scrollTop:t.offset().top-e+"px"},{duration:300,easing:"swing",complete:function(){isFromClick=!1}}),!1},getItem:function(t){return window.localStorage.getItem(c.prefix+t)},setItem:function(t,e){window.localStorage.setItem(c.prefix+t,e)}},l=function(){$(".gif").each(function(){var e=$("<div class='gif-container'>"),i=$(this),a=i.attr("data-src"),n=$("<canvas>"),s=parseInt(i.attr("width")),o=parseInt(i.attr("height")),r=s,c=o,l=$('<span class="stop"><span class="iconfont icon-stop"></span></span>').hide(),d=$('<span class="play"><span class="iconfont icon-play"></span></span>').hide(),h=$('<div class="lds-ring"><div></div><div></div><div></div><div></div></div>');function u(){var t=i.attr("auto"),a=$(".list-item").width();(r>a||void 0!==t)&&(c=a/s*o,r=a),i.attr("width",r),i.attr("height",c),r&&c&&(e.css({width:r,height:c}),!0===i.data("init")&&(n.attr("width",r).attr("height",c),n[0].getContext("2d").drawImage(i[0],0,0,r,c)))}i.before(e),u(),e.append(i).append(d).append(l).append(h),i.hide(),i.attr("src",a),i.on("load",function(){if(h.hide(),d.show(),!0===i.data("init"));else{e.append(n),n.attr("width",r).attr("height",c),(new Image).src=i.attr("src"),n[0].getContext("2d").drawImage(i[0],0,0,r,c),i.hide();var t=!1;d.on("click",function(e){t||(n.hide(),i.show(),i.attr("src","").attr("src",a),d.addClass("fadeOut"),setTimeout(function(){d.hide(),l.show().removeClass("fadeOut")},500),t=!0)}),l.on("click",function(e){t&&(n.show(),i.hide(),l.addClass("fadeOut"),setTimeout(function(){l.hide(),d.show().removeClass("fadeOut")},500),t=!1)}),i.data("init",!0)}}),t.resize(u)})},d={allLength:0,activeIndex:0,isDuringScroll:!1,init:function(){var i,a,n,s=$(".img-list"),o=$('<div class="list-container">'),r=s.find("img"),c=$('<div class="img-container">'),l=$('<div class="preview-list-container">');d.allLength=r.length;var h=$('<div class="preview-container">');r.each(function(){var t=$('<div class="wrapper">'),e=$(this).attr("data-src"),i=e+"?x-oss-process=style/preview";if(t.attr("data-src",e),t.css({"background-image":"url("+i+")"}),$(this).attr("data-desc")){var a=$('<span class="desc">').text($(this).attr("data-desc"));t.append(a)}c.append(t);var n=$('<div class="preview-wrapper">'),s=$('<div class="preview">');s.css({"background-image":"url("+i+")"}),n.append(s),h.append(n)});var u=$('<div class="hover">'),f=$('<div class="progress">');r.each(function(){var t=$('<div class="each-progress">');f.append(t)}),s.empty(),o.append(c),o.append(f),l.append(h),s.append(o),s.append(l),s.append(u),i=$(".wrapper");var v=$(".each-progress");v.eq(0).addClass(e);var p=$(".preview-wrapper");p.eq(0).addClass(e),C(0),w(),t.resize(w);var g=-1,m=-1;function w(){a=parseInt(s.css("width")),c.css("width",a*r.length),i.css("width",a),n=parseInt(p.css("width")),h.css("width",n*p.length),d.isDuringScroll||(k(d.activeIndex,!1),I(d.activeIndex),x(d.activeIndex,!1))}function C(t){var e=i.eq(t);if(e.length>0&&"true"!==e.attr("data-load")){var a=e.attr("data-src");e.attr("data-load","true");var n=new Image;n.src=a,n.onload=function(){e.css({"background-image":"url("+a+")"})}}}function k(t,e){C(t);var i=t*a+"px";!1!==e?$(o).animate({scrollLeft:i},{duration:500,easing:"swing",complete:function(){d.isDuringScroll=!1}}):$(o).scrollLeft(t*a)}function I(t){v.removeClass(e),v.eq(t).addClass(e)}function x(t,i){var a=t*n;d.activeIndex>t?a+=2*n:a-=2*n,p.removeClass(e),p.eq(t).addClass(e),!1!==i?$(l).animate({scrollLeft:a+"px"},{duration:500,easing:"swing",complete:function(){d.isDuringScroll=!1}}):$(l).scrollLeft(a)}u.on("touchstart",function(t){g=t.originalEvent.touches[0].pageX,m=-1}),u.on("touchmove",function(t){m=t.originalEvent.touches[0].pageX}),u.on("touchend",function(){var t=g-m;t>0&&Math.abs(t)>50?function(){if(!d.isDuringScroll){d.isDuringScroll=!0,d.activeIndex++;var t=d.activeIndex=d.activeIndex>d.allLength-1?0:d.activeIndex;k(t),I(t),x(t)}}():t<0&&Math.abs(t)>50&&function(){if(!d.isDuringScroll){d.isDuringScroll=!0,d.activeIndex--;var t=d.activeIndex=d.activeIndex<0?d.allLength-1:d.activeIndex;k(t),I(t),x(t)}}()}),p.on("click",function(){if(!d.isDuringScroll){var t=d.activeIndex=p.index($(this));k(t),x(t)}})}},h=function(){var e=$("#nav-bar"),a=$(".head-link"),o=$(".link-container"),r=e.find("ol.toc"),l=c.throttle(function(){var r=t.scrollTop();r>=n?(a.addClass(i),e.addClass(i),o.addClass(i)):r<=s&&(a.removeClass(i),e.removeClass(i),o.removeClass(i))},32);!function(e,i,a,n){var s=n.offset,o=i||"is-active",r=[],l=-1,d=$(e||".nav-link"),h=!1;d.each(function(){var t=$(this).children(".toc-link").attr("href"),e=decodeURI(t.substr(1,t.length));r.push($("#"+e).offset().top-s)}),r.push($(document).height()),d.on("click",function(t){console.log($(this));var e=$(this).children(".toc-link").attr("href"),i=e.substr(1,e.length);c.scrollTo($("#"+i),s),$(this).hasClass(o)||(d.removeClass(o),$(this).addClass(o)),t.stopPropagation()});var u=c.throttle(function(){if(h)return!1;var t=$(document).scrollTop();t=void 0!==t?t:window.pageYOffset,r.some(function(e,i){if(t+1<e){var n=i-1;if(n!==l&&n>=0){var s=d.eq(n);s&&!s.hasClass(o)&&(d.removeClass(o),s.addClass(o)),l=n,$.isFunction(a)&&a(s,l)}return!0}return!1})},100);u();t.scroll(function(){u()})}(".toc-item",null,function(t){var e=t.position().top;const i=r.innerHeight();(e>i||e<0)&&$(r).animate({scrollTop:t[0].offsetTop-i/2+"px"},{duration:100,easing:"swing",complete:function(){}})},{offset:78}),l(),t.scroll(function(){l()})},u={isMenuHide:!1,$linkUl:$("ul.some-link"),$linkIcon:$("a#link-list i"),init:function(){u.initEvent()},initEvent:function(){var e=$("#light-or-not"),i=$("html");e.on("click",function(){i.addClass("transition-all-color"),i.hasClass("night")?(i.removeClass("night"),c.setItem("theme","light")):(i.addClass("night"),c.setItem("theme","night")),setTimeout(function(){i.removeClass("transition-all-color")},500)});var a=$("#up-to-top");a.on("click",function(){c.scrollTo($("body"))}),$(this).scrollTop()>400&&a.show(),t.on("scroll",function(){$(this).scrollTop()>400?a.show():a.hide()})}},f={init:function(){var a=$(".toolbar");a.find(".icon-menu").on("click",function(t){a.addClass(e),$(".head-link").addClass(e),$("body").addClass("no-scroll"),t.stopPropagation()}),a.on("click",function(){a.removeClass(e),$(".head-link").removeClass(e),$("body").removeClass("no-scroll")});var n=c.throttle(function(){t.scrollTop()>200?a.addClass(i):a.removeClass(i)},100);n(),f.acitveLink(),t.on("scroll",function(){n()})},acitveLink:function(){var t=$(".head-link .btn"),i=window.location.pathname;t.each(function(){$(this).attr("href")===i&&$(this).addClass(e)})}},v=function(){var t=$("body").find("#data-title");t.length>0?t.txt(eachTitle):(t=$("<div>").attr({id:"data-title",class:"pop-title"}),$("body").append(t)),$(".pop").hover(function(){var e=$(this).offset().top,i=$(this).outerWidth(),a=$(this).outerHeight(),n=$(this).offset().left,s=$(this).attr("data-title"),o=$(this).attr("data-direction");t.html(s);var r=t.outerWidth(),c=t.outerHeight();switch(t.removeClass("left").removeClass("right").removeClass("top").removeClass("bottom"),t.addClass(o),o){case"right":e+=a/2,n=n+i+r/2+10;break;case"left":e+=a/2,n=n-r/2-10;break;case"bottom":e=e+a+c/2+10,n+=i/2;break;case"top":e=e-c/2-10,n+=i/2}t.css({top:e,left:n}),t.fadeIn()},function(){t.hide()})},p=function(){$("a").on("click",function(t){if(!$(this).hasClass("toc-link")){var i=$(this).attr("href");i&&!$(this).attr("target")&&($(".loading").addClass(e),window.location=i,t.preventDefault())}}),"Windows"!==navigator.platform&&"Win32"!==navigator.platform||$("body").addClass("win"),document.querySelector(".article").addEventListener("dblclick",function(t){t.preventDefault(),zoom.to({element:t.target,scale:1.5})})},g={init:function(){g.inSafeFrame()},inSafeFrame:function(){if(window.top!==window&&document.referrer){var t=document.createElement("a");t.href=document.referrer;var e=t.hostname,i=function(t,e){return-1!==t.indexOf(e,t.length-e.length)};i(e,".edeity.me")||i(e,"localhost")||(top.location.href="https://blog.edeity.me")}}};l(),d.init(),u.init(),v(),p(),g.init(),f.init(),!0===r.toc&&h(),!0===r.use_pwa&&h()});